{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "http://example.com/example.json",
  "type": "object",
  "title": "The Root Schema",
  "description": "The root schema comprises the entire JSON document.",
  "required": [
    "data"
  ],
  "properties": {
    "data": {
      "$id": "#/properties/data",
      "type": "object",
      "title": "The Data Schema",
      "required": [
        "id",
        "type",
        "attributes"
      ],
      "properties": {
        "id": {
          "$id": "#/properties/data/properties/id",
          "type": "string",
          "minLength": 36,
          "maxLength": 36,
          "title": "The Id Schema"
        },
        "type": {
          "$id": "#/properties/data/properties/type",
          "type": "string",
          "title": "The Type Schema"
        },
        "attributes": {
          "$id": "#/properties/data/properties/attributes",
          "type": "object",
          "title": "The Attributes Schema",
          "required": [
            "statementId",
            "procedureId",
            "textualReference"
          ],
          "oneOf": [
            {
              "required": ["segments"],
              "description": "Legacy position-based segmentation format"
            },
            {
              "required": ["contentBlocks"],
              "description": "New order-based segmentation format"
            }
          ],
          "properties": {
            "statementId": {
              "$id": "#/properties/data/properties/attributes/properties/statementId",
              "type": "string",
              "minLength": 36,
              "maxLength": 36,
              "title": "The Statementid Schema"
            },
            "procedureId": {
              "$id": "#/properties/data/properties/attributes/properties/procedureId",
              "type": "string",
              "minLength": 36,
              "maxLength": 36,
              "title": "The Procedureid Schema"
            },
            "textualReference": {
              "$id": "#/properties/data/properties/attributes/properties/textualReference",
              "type": "string",
              "title": "The Textualreference Schema",
              "description": "Text the segments are based on. Segments will be defined based on this text, by means of the list of charStart and charEnd pairs."
            },
            "segments": {
              "$id": "#/properties/data/properties/attributes/properties/segments",
              "type": "array",
              "title": "The Segments Schema",
              "description": "Array with the Segments Drafts (legacy position-based format)",
              "items": {
                "$id": "#/properties/data/properties/attributes/properties/segments/items",
                "type": "object",
                "title": "The Items Schema",
                "description": "Segment Draft.",
                "required": [
                  "id",
                  "tags"
                ],
                "properties": {
                  "id": {
                    "$id": "#/properties/data/properties/attributes/properties/segments/items/properties/id",
                    "type": "string",
                    "minLength": 36,
                    "maxLength": 36,
                    "title": "The Id Schema",
                    "description": "An explanation about the purpose of this instance."
                  },
                  "charStart": {
                    "$id": "#/properties/data/properties/attributes/properties/segments/items/properties/charStart",
                    "type": "integer",
                    "title": "The Charstart Schema",
                    "description": "Tells the position in textualReference where the segment starts"
                  },
                  "charEnd": {
                    "$id": "#/properties/data/properties/attributes/properties/segments/items/properties/charEnd",
                    "type": "integer",
                    "title": "The Charend Schema",
                    "description": "Tells the position in textualReference where the segment ends"
                  },
                  "assigneeId": {
                    "$id": "#/properties/data/properties/attributes/properties/segments/items/properties/assignee",
                    "type": "string",
                    "minLength": 36,
                    "maxLength": 36
                  },
                  "placeId": {
                    "$id": "#/properties/data/properties/attributes/properties/segments/items/properties/place",
                    "type": "string",
                    "minLength": 36,
                    "maxLength": 36
                  },
                  "tags": {
                    "$id": "#/properties/data/properties/attributes/properties/segments/items/properties/tags",
                    "type": "array",
                    "title": "The Tags Schema",
                    "items": {
                      "$id": "#/properties/data/properties/attributes/properties/segments/items/properties/tags/items",
                      "type": "object",
                      "title": "The Tag Items Schema",
                      "required": [
                        "tagName", "id"
                      ],
                      "properties": {
                        "tagName": {
                          "$id": "#/properties/data/properties/attributes/properties/segments/items/properties/tags/items/properties/tagName",
                          "type": "string",
                          "title": "Tagname Schema",
                          "description": "Tag name as stored by PI and dev backend"
                        },
                        "id": {
                          "$id": "#/properties/data/properties/attributes/properties/segments/items/properties/tags/items/properties/id",
                          "type": "string",
                          "minLength": 36,
                          "maxLength": 36,
                          "title": "The id Schema",
                          "description": "Tag id as stored by PI and Dev backend."
                        }
                      }
                    }
                  }
                }
              }
            },
            "contentBlocks": {
              "$id": "#/properties/data/properties/attributes/properties/contentBlocks",
              "type": "array",
              "title": "The ContentBlocks Schema",
              "description": "Array with content blocks in order-based format (segments and text sections)",
              "items": {
                "$id": "#/properties/data/properties/attributes/properties/contentBlocks/items",
                "type": "object",
                "title": "The ContentBlock Items Schema",
                "description": "A content block (segment or text section)",
                "required": [
                  "id",
                  "type",
                  "order"
                ],
                "properties": {
                  "id": {
                    "$id": "#/properties/data/properties/attributes/properties/contentBlocks/items/properties/id",
                    "type": "string",
                    "minLength": 36,
                    "maxLength": 36,
                    "title": "The Id Schema"
                  },
                  "type": {
                    "$id": "#/properties/data/properties/attributes/properties/contentBlocks/items/properties/type",
                    "type": "string",
                    "enum": ["segment", "textSection"],
                    "title": "The Type Schema",
                    "description": "Type discriminator: 'segment' for segments, 'textSection' for text sections"
                  },
                  "order": {
                    "$id": "#/properties/data/properties/attributes/properties/contentBlocks/items/properties/order",
                    "type": "integer",
                    "minimum": 1,
                    "title": "The Order Schema",
                    "description": "Sequential position in the statement (1, 2, 3, ...)"
                  },
                  "text": {
                    "$id": "#/properties/data/properties/attributes/properties/contentBlocks/items/properties/text",
                    "type": "string",
                    "title": "The Text Schema",
                    "description": "The text content of this block"
                  },
                  "sectionType": {
                    "$id": "#/properties/data/properties/attributes/properties/contentBlocks/items/properties/sectionType",
                    "type": "string",
                    "enum": ["heading", "paragraph", "list"],
                    "title": "The SectionType Schema",
                    "description": "Type of text section (only for type='textSection')"
                  },
                  "assigneeId": {
                    "$id": "#/properties/data/properties/attributes/properties/contentBlocks/items/properties/assigneeId",
                    "type": "string",
                    "minLength": 36,
                    "maxLength": 36,
                    "title": "The AssigneeId Schema",
                    "description": "Assigned user ID (only for type='segment')"
                  },
                  "placeId": {
                    "$id": "#/properties/data/properties/attributes/properties/contentBlocks/items/properties/placeId",
                    "type": "string",
                    "minLength": 36,
                    "maxLength": 36,
                    "title": "The PlaceId Schema",
                    "description": "Place ID (only for type='segment')"
                  },
                  "tags": {
                    "$id": "#/properties/data/properties/attributes/properties/contentBlocks/items/properties/tags",
                    "type": "array",
                    "title": "The Tags Schema",
                    "description": "Tags array (only for type='segment')",
                    "items": {
                      "$id": "#/properties/data/properties/attributes/properties/contentBlocks/items/properties/tags/items",
                      "type": "object",
                      "title": "The Tag Items Schema",
                      "required": [
                        "tagName", "id"
                      ],
                      "properties": {
                        "tagName": {
                          "$id": "#/properties/data/properties/attributes/properties/contentBlocks/items/properties/tags/items/properties/tagName",
                          "type": "string",
                          "title": "Tagname Schema"
                        },
                        "id": {
                          "$id": "#/properties/data/properties/attributes/properties/contentBlocks/items/properties/tags/items/properties/id",
                          "type": "string",
                          "minLength": 36,
                          "maxLength": 36,
                          "title": "The id Schema"
                        }
                      }
                    }
                  }
                }
              }
            },
            "segmentationStatus": {
              "$id": "#/properties/data/properties/attributes/properties/segmentationStatus",
              "type": "string",
              "enum": ["unsegmented", "SEGMENTED"],
              "title": "The SegmentationStatus Schema",
              "description": "Status indicating whether statement uses legacy or new segmentation format"
            }
          }
        }
      }
    }
  }
}
